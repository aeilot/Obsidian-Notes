两个向量点积为 0 时，两个向量正交 $\mathbf{v}\cdot \mathbf{u}=0$

![[Introduction to Linear Algebra.pdf#page=153&rect=69,413,449,440|Introduction to Linear Algebra, p.143]]

# 4.1 向量和子空间的正交性

$Ax=0 \implies$ **行空间和零空间正交**

![[Pasted image 20250922101732.png]]

$A$ 的每一行都与 $x$ 正交 $\implies$ 行空间是由 A 的所有行向量张成（span）的。如果一个向量 x 与所有基向量（即 A 的行向量）都正交，那么它必然与这些基向量的任何线性组合都正交。

同理：**列空间与左零空间正交**

![[Introduction to Linear Algebra.pdf#page=155&rect=76,278,441,314|Introduction to Linear Algebra, p.145]]

## 正交补

如果两个正交子空间 $V和W$，有 $dimV+dimW=n$，称二者为**正交补**（orthogonal complement），$W=V^{\perp}$

![[Introduction to Linear Algebra.pdf#page=155&rect=81,105,440,164|Introduction to Linear Algebra, p.145]]

![[Introduction to Linear Algebra.pdf#page=155&rect=55,59,460,106|Introduction to Linear Algebra, p.145]]

## 线性代数基本定理（第二部分）

![[Introduction to Linear Algebra.pdf#page=156&rect=82,583,428,655|Introduction to Linear Algebra, p.146]]

列空间中任意向量 $b=Ax_{r}$，行空间中向量 $x_{r}$ 是唯一的

任意秩为 $r$ 的矩阵都能找到一个 $r\times r$ 的可逆子矩阵 $\implies$ $A^+$ 伪逆（广义逆）

同时存在于两个正交子空间中的唯一向量，就是零向量

## 从基到子空间

在一个 n 维空间 Rⁿ 中，对于 n 个向量，**线性无关**和**张成整个空间**这两个条件是等价的

一个方阵的列向量线性无关 ⟺ 列向量能张成 Rⁿ ⟺ 矩阵可逆 ⟺ Ax=b 恒有唯一解 ⟺ $AB=I \implies BA=I$ ⟺ det(A)≠0

向量的正交分解：$x = x_{r} + x_{n}$ where $x_r \in \text{row space}(A)$ and $x_n \in \text{null space}(A)$

# 4.2 直线与子空间上的投影

一个向量 **b** 在某个子空间（如直线或平面）上的**投影 p**，是 **b** 在该子空间中的分量。从几何上看，它是从 **b** 的终点向该子空间作垂线，垂足点与原点连接构成的向量。而投影矩阵 **P** 是一种线性变换，可以将任何向量映射到该子空间上，从而计算出其投影。

## 在直线上的投影

![[Introduction to Linear Algebra.pdf#page=163&rect=47,306,476,453|Introduction to Linear Algebra, p.153]]

误差向量 $\mathbf{e}=\mathbf{b}-\mathbf{p}$，投影向量 $\mathbf{p}=\hat{x}\mathbf{a}$

![[Introduction to Linear Algebra.pdf#page=163&rect=86,488,431,545|Introduction to Linear Algebra, p.153]]

![[Introduction to Linear Algebra.pdf#page=163&rect=68,217,451,304|Introduction to Linear Algebra, p.153]]

![[Introduction to Linear Algebra.pdf#page=164&rect=96,565,407,609|Introduction to Linear Algebra, p.154]]

$\mathbf{b} = \mathbf{p} +\mathbf{e}$

投影矩阵：

![[Introduction to Linear Algebra.pdf#page=164&rect=73,428,436,483|Introduction to Linear Algebra, p.154]]

对于投影矩阵有：$\mathbf{P}^2=\mathbf{P}$

矩阵 $I-P$ 也是一个投影矩阵，投影到与子空间垂直的另一个子空间上

$$
P'=I-P \implies P'x=x-Px=x-p=e
$$

## 投影到子空间上

线性空间 $\mathbb{R}^m$ 中有 $n$ 个线性无关的列向量 $a_{1},a_{2},a_{3},\dots,a_{n}$，他们组合成矩阵 $A$

需要找到 $m$ 维向量 $b$ 在 $C(A)$ 上的投影 $\mathbf{p}=A\hat{x}$

原理：$a^Te=0$ 有 $A^T(b-A\hat{x})=0$

![[Introduction to Linear Algebra.pdf#page=165&rect=54,56,462,251|Introduction to Linear Algebra, p.155]]

$\mathbf{e}\in \mathbf{N}(A^T)$，$a\in \mathbf{C}(A)$

$||e||$ 是 $\mathbf{b}$ 到 $\mathbf{C}(A)$ 的距离

注意：$A$ 不是方阵，故 $A$ 不可逆，不可以拆开 $(A^TA)^{-1}$

![[Introduction to Linear Algebra.pdf#page=167&rect=89,470,428,508|Introduction to Linear Algebra, p.157]]

![[Introduction to Linear Algebra.pdf#page=167&rect=75,270,445,294|Introduction to Linear Algebra, p.157]]

![[Introduction to Linear Algebra.pdf#page=168&rect=64,528,465,665|Introduction to Linear Algebra, p.158]]

# 4.3 最小二乘法

#TODO

# 4.4 标准正交基和 Gram-Schmidt

两两正交的单位向量 $\implies$ 标准正交基

![[Introduction to Linear Algebra.pdf#page=186&rect=63,111,466,208|Introduction to Linear Algebra, p.176]]

![[Introduction to Linear Algebra.pdf#page=187&rect=61,530,464,643|Introduction to Linear Algebra, p.177]]

当 $Q$ 是方阵的时候，称为 正交矩阵

![[Introduction to Linear Algebra.pdf#page=188&rect=57,31,455,116|Introduction to Linear Algebra, p.178]]

正交矩阵保持长度，在计算机中保证了数据不会过大而溢出数据结构范围

## Gram-Schmidt 过程

![[Introduction to Linear Algebra.pdf#page=190&rect=60,63,457,400|Introduction to Linear Algebra, p.180]]

第一个向量不做操作，每次引入一个新向量，新向量减去它在已有向量方向上的投影

最后把每个向量化为单位向量

得到标准正交基

## A = QR 分解

![[Introduction to Linear Algebra.pdf#page=192&rect=59,350,455,450|Introduction to Linear Algebra, p.182]]

## 总结

![[Introduction to Linear Algebra.pdf#page=194&rect=71,307,469,474|Introduction to Linear Algebra, p.184]]

# 4.5 矩阵的伪逆

每一个矩阵都有一个伪逆（左逆或者右逆）

![[Introduction to Linear Algebra.pdf#page=200&rect=61,327,467,473|Introduction to Linear Algebra, p.190]]

 伪逆的一个重要性质是它在最小二乘解和低秩逼近中的应用，提供了矩阵在不可逆时的一种广义解法

对于任何线性方程组 $A\mathbf{x} = \mathbf{b}$，伪逆矩阵 $A^+$ 都能给出一个“最佳”解 $\mathbf{x}^+ = A^+\mathbf{b}$。这个解在两个方面是最佳的：

1.  **最小化误差**：它使得误差 $\|A\mathbf{x} - \mathbf{b}\|^2$ 最小（最小二乘解）。
2.  **最小化长度**：在所有能最小化误差的解中，它自身的长度（范数）$\|\mathbf{x}\|$ 是最小的（最小范数解）。

* 伪逆给出的解 $\mathbf{x}^+$ 本身不包含任何来自 $A$ 的零空间的分量（nullspace component = 0），这意味着它完全位于 $A$ 的行空间 (row space) 中。这保证了它的范数是最小的。
* 计算伪逆 $A^+$ 的方法有多种，例如通过奇异值分解 (SVD) 或 $QR$ 分解等。


> [!NOTE]
> ### 1. 左栏：超定问题 (Overdetermined System) - 最小二乘解
> 
> * **情况**：当矩阵 $A$ 是一个 $m \times n$ 的矩阵，且**列满秩**时，即 $rank(A) = r = n < m$。这意味着方程的数量 $m$ 比未知数的数量 $n$ 多。
> * **问题**：方程太多，通常导致方程组**无解**。
> * **目标**：既然找不到精确解，我们的目标就变成找到一个向量 $\hat{\mathbf{x}}$，使得 $A\hat{\mathbf{x}}$ 与 $\mathbf{b}$ 尽可能接近。也就是说，我们要最小化误差向量 $\mathbf{e} = \mathbf{b} - A\hat{\mathbf{x}}$ 的长度。
> * **解决方案**：这个解被称为**最小二乘解 (least squares solution)**，由 $\hat{\mathbf{x}} = A^+\mathbf{b}$ 给出。在这种情况下，$A^+$ 是 $A$ 的**左逆 (left inverse)**，满足 $A^+A = I$（$I$ 是单位矩阵）。
> 
> ### 2. 右栏：欠定问题 (Underdetermined System) - 最小范数解
> 
> * **情况**：当矩阵 $A$ 是一个 $m \times n$ 的矩阵，且**行满秩**时，即 $rank(A) = r = m < n$。这意味着未知数的数量 $n$ 比方程的数量 $m$ 多。
> * **问题**：方程太少，导致方程组有**无穷多解**。
> * **目标**：既然有无穷多个解，我们就需要一个标准来挑选出“最好”的一个。通常我们选择那个长度（范数）最小的解。
> * **解决方案**：这个解被称为**最小范数解 (minimum length/norm solution)**，由 $\mathbf{x}^+ = A^+\mathbf{b}$ 给出。在这种情况下，$A^+$ 是 $A$ 的**右逆 (right inverse)**，满足 $AA^+ = I$。
>     * 任何其他的解都可以表示为 $\mathbf{x} = \mathbf{x}^+ + \mathbf{x}_n$，其中 $\mathbf{x}_n$ 是 $A$ 的零空间 (nullspace) 中的一个非零向量。因为 $\mathbf{x}^+$ 与 $\mathbf{x}_n$ 正交，所以任何其他解的长度都会比 $\mathbf{x}^+$ 的长度更长。
> 
> ### 3. 中间部分：秩亏缺的一般情况 (Rank-Deficient Case)
> 
> * **情况**：当矩阵 $A$ **既不是行满秩也不是列满秩**时，即 $rank(A) = r < m$ 且 $r < n$。
> * **问题**：这种情况综合了前两种问题。方程组可能无解，即便有解，解也不唯一。
> * **目标**：我们需要一个解，它既能像最小二乘解那样最小化误差，又能像最小范数解那样在所有可能的“最小二乘解”中选择长度最短的那个。
> * **解决方案**：通用的**伪逆 (pseudoinverse)** $A^+$ 就能做到这一点。它给出的解 $\mathbf{x}^+ = A^+\mathbf{b}$ 具有以下两个最优性质：
>     1.  **最小化误差**：在所有可能的向量 $\mathbf{x}$ 中，$\mathbf{x}^+$ 使得误差 $\|A\mathbf{x} - \mathbf{b}\|^2$ 达到最小。
>     2.  **最小化范数**：在所有能使误差最小的向量 $\mathbf{x}$ 中，$\mathbf{x}^+$ 本身的范数 $\|\mathbf{x}\|$ 是最小的。
## 伪逆

对于瘦高的矩阵（$m>n$）：

A $(m\times n)$ 存在伪逆 $A^+$ $(n\times m)$

![[Introduction to Linear Algebra.pdf#page=201&rect=55,500,449,537|Introduction to Linear Algebra, p.191]]

列空间和左零空间互为正交补，张成整个空间，故任意向量都可以写成 $y=b+z$

伪逆将列空间的向量映射到行空间，左零空间的向量映射到零向量

故伪逆实现了 invert A when it can

![[Introduction to Linear Algebra.pdf#page=201&rect=44,170,473,419|Introduction to Linear Algebra, p.191]]

![[Introduction to Linear Algebra.pdf#page=201&rect=46,53,468,93|Introduction to Linear Algebra, p.191]]

于是我们找到了两个投影矩阵

* **行空间投影** ($P_{\text{row}}$)：将任意向量投影到 $A$ 的行空间。

    $$
    P_{\text{row}} = A^+A
    $$

* **列空间投影** ($P_{\text{col}}$)：将任意向量投影到 $A$ 的列空间。

    $$
    P_{\text{col}} = AA^+
    $$

![[Introduction to Linear Algebra.pdf#page=202&rect=51,21,465,176|Introduction to Linear Algebra, p.192]]

## 用 A = CR 求伪逆

C 有 r 个线性无关的列，存在左逆；同理 R 存在左逆

对于 A = CR 有

![[Introduction to Linear Algebra.pdf#page=203&rect=70,123,431,174|Introduction to Linear Algebra, p.193]]

## $A^+$ 的性质

![[Introduction to Linear Algebra.pdf#page=204&rect=54,513,457,579|Introduction to Linear Algebra, p.194]]

# 总结

* **核心特性**：正交矩阵 $Q$ 代表着**旋转**和**反射**。它在乘以一个向量时，能保持向量的**长度**、向量之间的**角度**和**内积**不变。
* **最大优势**：对于一个方阵 $Q$，它的逆矩阵就是它的转置矩阵 ($Q^{-1} = Q^T$)。求转置远比求逆矩阵简单，这使得求解线性方程组 $Q\mathbf{x}=\mathbf{b}$ 变得极其容易，解就是 $\mathbf{x}=Q^T\mathbf{b}$。
* **核心作用**：正交矩阵是许多重要矩阵分解（如 QR 分解、奇异值分解 SVD、谱分解）的基石，用于将复杂矩阵分解为更简单、性质更好的矩阵组合。
#### 几何性质：保持长度和角度不变

1.  **长度保持 (Length Preservation)**
    * 公式：$\|Q\mathbf{x}\|^2 = \|\mathbf{x}\|^2$
    * 解释：用正交矩阵 $Q$ 乘以任意向量 $\mathbf{x}$，新向量 $Q\mathbf{x}$ 的长度与原向量 $\mathbf{x}$ 完全相同。这是因为 $Q^TQ=I$（单位矩阵），所以 $(Q\mathbf{x})^T(Q\mathbf{x}) = \mathbf{x}^TQ^TQ\mathbf{x} = \mathbf{x}^TI\mathbf{x} = \mathbf{x}^T\mathbf{x}$。

2.  **内积保持 (Dot Product Preservation)**
    * 公式：$(Q\mathbf{x})^T(Q\mathbf{y}) = \mathbf{x}^T\mathbf{y}$
    * 解释：两个向量 $\mathbf{x}$ 和 $\mathbf{y}$ 分别经过 $Q$ 变换后，它们之间的新内积与旧内积完全相同。由于内积定义了向量间的夹角，这也意味着**角度也被保持**了。

#### 计算优势：转置即是逆

4.  **方阵的逆 (Inverse of a Square Matrix)**
    * 如果 $Q$ 是一个方阵，那么它的转置就是它的逆：$Q^T = Q^{-1}$。这是正交矩阵最有用的性质之一，它将复杂的求逆运算简化为简单的转置运算。

5.  **长方形矩阵与最小二乘解 (Rectangular Matrix and Least Squares)**
    * 当 $Q$ 是一个 $m \times n$（$m > n$）的“高瘦”矩阵，且其列向量两两正交时，它不是方阵，没有逆矩阵。
    * 在这种情况下，求解方程 $Q\mathbf{x}=\mathbf{b}$ 的最小二乘解（即最佳近似解）$\hat{\mathbf{x}}$ 非常简单，公式依然是 $\hat{\mathbf{x}}=Q^T\mathbf{b}$。
    * 这里的 $Q^T$ 正是 $Q$ 的**伪逆** ($Q^+$)。
    * 投影到 $Q$ 的列空间的投影矩阵是 $P = QQ^T$。

#### 代数性质

5.  **闭包性与行列式 (Closure and Determinant)**
    * 正交矩阵的乘积（$Q_1Q_2...$）和幂 ($Q^N$) 仍然是正交矩阵。
    * 正交矩阵的行列式的值一定是 $+1$ 或 $-1$。值为 $+1$ 代表纯粹的旋转，值为 $-1$ 代表包含反射的变换。

#### 在矩阵分解中的核心作用

正交矩阵是分解其他更复杂矩阵的关键工具，它们通常用于构建一个“良好”的坐标系。

6.  **对称矩阵的特征向量 (Eigenvectors of Symmetric Matrix)**
    * 任何对称矩阵 $S$ 的特征向量都可以被选为一组标准正交基。这意味着对称矩阵可以被正交对角化：$S = QDQ^T$，其中 $Q$ 是由特征向量构成的正交矩阵。

7.  **奇异向量 (Singular Vectors)**
    * 任何矩阵 $A$ 的奇异向量构成了两组标准正交基。这是**奇异值分解 (SVD)** 的基础：$A = U\Sigma V^T$，其中 $U$ 和 $V$ 都是正交矩阵。

8.  **极分解 (Polar Decomposition)**
    * 公式：$A = QS$
    * 解释：任何可逆矩阵 $A$ 都可以分解为一个正交矩阵 $Q$ (旋转/反射部分) 和一个对称正定矩阵 $S$ (拉伸/缩放部分)。这类似于复数 $z=re^{i\theta}$ 的分解。

9.  **QR 分解 (QR Decomposition)**
    * 公式：$A = QR$
    * 解释：任何可逆矩阵 $A$ 都可以分解为一个正交矩阵 $Q$ 和一个上三角矩阵 $R$。这个分解源于**格拉姆 - 施密特正交化 (Gram-Schmidt)** 过程，是数值线性代数中求解线性方程组和特征值问题最重要的方法之一。