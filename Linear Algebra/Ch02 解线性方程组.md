## 消元法
### 线性方程组解的个数

对于一个 $n\times n$ 的矩阵：可能无解，可能恰一个解，可能无穷解。

#### 1. 矩阵秩为 n

$\mathbf{A}\mathbf{x}=\mathbf{b}$ 有且仅有一个解

$\mathbf{A}\mathbf{x}=\boldsymbol{0}$ 仅有一个解 $\mathbf{x} = \boldsymbol{0}$

$\mathbf{A}$ 有逆矩阵 

#### 2. 矩阵无解

$\mathbf{b}$ 不在 $\mathbf{X}$ 的列空间内

#### 3. 有无穷多个解

$\mathbf{b}$ 在 $\mathbf{X}$ 的列空间内，且矩阵不满秩（$r<n$）

$\mathbf{b}$ is in $\mathbf{C}(\mathbf{A})$ and $\mathbf{A}$ has dependent columns

![[Screenshot 2025-09-04 at 11.09.43 AM.png]]

### 基本方法

1. **写出增广矩阵 `[A | b]`。**
2. **正向消元**：利用主元和行操作，在主对角线下方制造全 0，得到 `[U | c]`。
3. **反向代入**：从下往上解 `Ux = c`，依次得到最后一个到第一个未知数的值。

![[Screenshot 2025-09-04 at 11.22.10 AM.png]]

> [!important] 注意事项
> 主元不为 0
> 
> 求秩：$\mathbf{A}$ 中有 $n$ 个不为零的主元 $\to$ $r=n$

### 行交换

当主元无法出现在对角线上时，可以左乘一个置换矩阵，进行行交换操作。

在线性代数中，每一个行操作都可以用一个“初等矩阵”左乘来实现。执行行交换操作的矩阵叫做**置换矩阵 (Permutation Matrix)**，通常记作 $\mathbf{P}$。

![[Screenshot 2025-09-05 at 10.32.53 AM.png]]

### 图解

![[Screenshot 2025-09-05 at 10.44.26 AM.png]]

### 几何意义

![[Screenshot 2025-09-05 at 10.40.07 AM.png]]

#### 行图像

每一行是一个方程，代表空间中的一个直线/平面/etc

求交点

#### 列图像

将方程组看作是列向量的线性组合

$$
\mathbf{A}=\begin{bmatrix}
1 & -2 \\
1 & 1 
\end{bmatrix}, 
\mathbf{b}=\begin{bmatrix}
-1  \\
2
\end{bmatrix}
$$

$$
\mathbf{A}\mathbf{x}=\mathbf{b}
$$

即 $\mathbf{b}$ 是 $\mathbf{A}$ 两列 $col_{1},col_{2}$ 的线性组合

方程组 `Ax = b` 是否有解，就等价于：**目标向量 `b` 是否位于矩阵 `A` 的列空间之中**

### 增广矩阵

增广矩阵，即 $\begin{bmatrix}\mathbf{A} & \mathbf{b}\end{bmatrix}$

进行高斯消元时，`A` 和 `b` 进行相同的操作，故将 `A` `b` 合并为一个矩阵，方便运算

## 消元矩阵与逆矩阵

### 逆矩阵

逆矩阵 $\to$ 撤销操作

$$
\mathbf{A}\mathbf{A^{-1}}=\mathbf{A^{-1}}\mathbf{A}=\mathbf{I}
$$

$$
\mathbf{A}\mathbf{x}=\mathbf{b}
\to
 \mathbf{x} = \mathbf{A^{-1}} \mathbf{b}
$$

![[Screenshot 2025-09-05 at 11.16.41 AM.png]]

> [!NOTE] 
> 
> 并不是所有的矩阵都可逆
> 
> 1. 当且仅当消元能够产生 $n$ 个主元，矩阵可逆
> 2. 矩阵 $\mathbf{A}$ 可逆时，$\mathbf{A}\mathbf{x}=\mathbf{b}$ 的唯一解是 $\mathbf{x}=\mathbf{A^{-1}}\mathbf{b}$
> 3. 逆矩阵唯一
> 4. 如果存在一个不为 0 的向量 $\mathbf{x}$ 使得 $\mathbf{A}\mathbf{x}=\mathbf{b}$，则 $\mathbf{A}$ 线性相关，$\mathbf{A}$ 不可逆。
> 5. 一个方阵可逆，当且仅当它列线性无关
> 6. 一个矩阵可逆，当且仅当其行列式不为 0
> 7. 若没有对角线上的元素为 0，三角矩阵可逆
> 8. **只有方阵才可能有逆矩阵**。一个非方阵（例如 2x3 矩阵）没有逆矩阵。
> 9. ![[Pasted image 20250909173003.png]]

#### 矩阵乘积的逆

![[Pasted image 20250905113033.png]]

$\to$ 矩阵乘法没有交换律

$\to$ 如果你有两个**方阵 (square matrices)** A 和 B，并且已经确认了其中一个顺序的乘积是**单位矩阵 (identity matrix)**（例如 BA=I），那么你无需再检查另一个顺序。AB=I 将**自动成立**。这意味着 B 是 A 真正的、双侧的**逆矩阵 (inverse)**。

- **左逆 (Left Inverse)**: 如果你找到了一个矩阵 B，使得 $BA=I$，那么 B 就是 A 的一个左逆。
    
- **右逆 (Right Inverse)**: 如果你找到了一个矩阵 C，使得 $AC=I$，那么 C 就是 A 的一个右逆。

$$
\mathbf{A}\mathbf{B}=\mathbf{I}\implies \mathbf{B}\mathbf{A}=\mathbf{I}
$$

> [!NOTE]
> ##### **定理：方阵的单侧逆是双侧逆**
> 
> **陈述**：
> 给定两个 $n \times n$ 的方阵 $A$ 和 $B$。如果 $BA=I$（其中 $I$ 是单位矩阵），那么必有 $AB=I$。
> 
> ---
> 
> ###### **证明过程**
> 
> **第一步：分析 $A$ 的零空间**
> 
> 我们的目标是从已知条件 $BA=I$ 出发，推导出 $AB=I$。
> 
> 1.  考察方程 $Ax=0$，其中 $x$ 是一个 $n \times 1$ 的列向量。这个方程的解集构成了矩阵 $A$ 的**零空间 (Nullspace)**。
> 
> 2.  在方程 $Ax=0$ 的两边同时左乘矩阵 $B$：
>
>     $$B(Ax) = B(0)$$
>
> 3.  利用矩阵乘法的结合律，得到：
>
>     $$(BA)x = 0$$
>
> 4.  根据我们的已知条件 $BA=I$，代入上式：
>
>     $$Ix = 0$$
>
> 5.  因为单位矩阵 $I$ 乘以任何向量都等于其自身，所以：
>
>     $$x = 0$$
>
> **结论**：以上推导表明，方程 $Ax=0$ 唯一的解是 $x=0$（零向量）。这意味着矩阵 $A$ 的零空间只包含零向量。
> 
> **第二步：推断 $A$ 的性质**
> 
> 6.  对于一个 $n \times n$ 的方阵，其零空间仅包含零向量，这等价于说该矩阵的 $n$ 个列向量是**线性无关的 (linearly independent)**。
> 
> 7.  在 $n$ 维空间 ($\mathbb{R}^n$) 中，任何 $n$ 个线性无关的向量都会构成该空间的一组**基 (basis)**。
> 
> 8.  因此，矩阵 $A$ 的 $n$ 个列向量构成 $\mathbb{R}^n$ 的一组基。
> 
> **第三步：证明 $AB=I$**
> 
> 9.  因为 $A$ 的列向量是 $\mathbb{R}^n$ 的一组基，这意味着对于**任意**一个 $n \times 1$ 的向量 $y$，方程 $Ax=y$ 都**有唯一解**。换句话说，矩阵 $A$ 是**可逆的 (invertible)**。
> 
> 10.  既然 $A$ 可逆，那么它必然存在一个唯一的逆矩阵，我们称之为 $A^{-1}$，满足：
>
>    $$AA^{-1} = I \quad \text{并且} \quad A^{-1}A = I$$
>
> 11.  现在回到我们的已知条件：
>
> $$BA=I$$
>
> 12.  在该等式的两边同时右乘 $A^{-1}$：
>
> $$(BA)A^{-1} = I(A^{-1})$$
>
> 13.  利用结合律：
>
> $$B(AA^{-1}) = A^{-1}$$
>
> 14.  因为 $AA^{-1}=I$，代入后得到：
>
> $$B(I) = A^{-1}$$
>
   > $$B = A^{-1}$$
>
> 15.  我们已经证明了矩阵 $B$ 就是 $A$ 的逆矩阵 $A^{-1}$。根据逆矩阵的定义，它必须同时满足左乘和右乘都得到单位矩阵。因此，既然 $B=A^{-1}$，那么必然有：
>
> $$AB = I$$
>
> **证毕。**
## $\mathbf{A}=\mathbf{L}\mathbf{U}$
### 基本定义

![[Screenshot 2025-09-05 at 11.10.53 AM.png]]

$\mathbf{L}$ 即下三角矩阵，是消元矩阵 $\mathbf{E}$ 的逆矩阵

![[Pasted image 20250905115019.png]]

### 高斯 - 若尔当消元法 (Gauss-Jordan Elimination)

高斯 - 若尔当消元法是**高斯消元法 (Gaussian Elimination)** 的一个 **“升级版”** 或 **“完整版”**。

- **高斯消元法**的目标是：通过行操作，将矩阵 A 变为一个**上三角矩阵 (Upper Triangular Matrix, U)**，然后通过“反向代入”求解。
    
- **高斯 - 若尔当消元法**的目标是：**继续**进行消元，不仅要消去主元下方的元素，**也要消去主元上方的元素**，最后再将所有主元都变为 1。最终得到的是一个**简化行阶梯形矩阵 (Reduced Row Echelon Form, RREF)**。对于一个可逆的方阵来说，这个最终形式就是**单位矩阵 (Identity Matrix, I)**。
#### 操作步骤（求矩阵的逆）

- **构建增广矩阵**: 将矩阵 $\mathbf{A}$ 和一个同等大小的单位矩阵 $\mathbf{I}$ 拼在一起，形成增广矩阵 $[A∣I]$。
    
- **执行消元**: 对**整个**增广矩阵 $[A∣I]$ 执行高斯 - 若尔当消元法。
    
- **得到结果**: 当左侧的 $A$ 变为单位矩阵 $I$ 时，右侧原来的 $I$ 就会自动变成 $A$ 的逆矩阵 $A^{-1}$。

$\to$ 原理：增广矩阵左乘 $A^{-1}$，$\mathbf{A}$ 变成 $\mathbf{I}$，$\mathbf{I}$ 变成 $A^{-1}$

#### 操作步骤（读出方程的解）

增广矩阵 $\begin{bmatrix}\mathbf{A} & \mathbf{b}\end{bmatrix} \to \begin{bmatrix}\mathbf{I} & \mathbf{x}\end{bmatrix}$

### 消元的计算成本

![[Pasted image 20250905121029.png]]

![[Pasted image 20250905121117.png]]

### $\mathbf{A}=\mathbf{L}\mathbf{U}$ 证明

![[Pasted image 20250905121654.png]]

矩阵 A 可以被看作是一系列“秩一矩阵” (rank-one matrix) 的和（高斯消元的逆向）

![[Pasted image 20250906165638.png]]

$$ A = LU = \begin{bmatrix} | & & | \\ \boldsymbol{l_1} & \dots & \boldsymbol{l_n} \\ | & & | \end{bmatrix} \begin{bmatrix} - & \boldsymbol{u_1} & - \\ & \vdots & \\ - & \boldsymbol{u_n} & - \end{bmatrix} = \boldsymbol{l_1}\boldsymbol{u_1} + \dots + \boldsymbol{l_n}\boldsymbol{u_n} $$

- $l_{k}$​ 是最终的下三角矩阵 **L** 的第 k 列。
    
- $u_{k}$​ 是最终的上三角矩阵 **U** 的第 k 行。
    
- $l_{k}u_{k}$​ 是一个列向量乘以一个行向量，结果是一个秩为 1 的矩阵。 
### 不需要行交换的情况

主元为 0 时需要左乘置换矩阵，进行行交换。

一个 $n \times n$ 矩阵 A 可以被分解为 `A = LU` （无行交换）的**充分必要条件**是： **A 的所有左上角 `k × k` 子矩阵 $A_k$ 都是可逆的 (invertible)，其中 k=1, 2, ..., n。

* **子矩阵 $A_k$**：指由 A 的前 k 行和前 k 列构成的矩阵。 $A_1 = [a_{11}]$  $A_2 = \begin{bmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{bmatrix}$ ... $A_n = A$

$$ \begin{bmatrix} A_k & * \\ * & * \end{bmatrix} = \begin{bmatrix} L_k & 0 \\ * & * \end{bmatrix} \begin{bmatrix} U_k & * \\ 0 & * \end{bmatrix} $$

 * 从这个乘法中，我们可以直接得到左上角部分的等式： 

$$ A_k = L_k U_k $$

* 所有 $A_{k}$ 都必须可逆，才能够进行 LU 分解
### $A=LDU$

$E^{-1}$ 可以再分解为 $DU$，每一行除以主元，将 $U$ 对角线化为 1，$D$ 是一个对角矩阵，其对角线是主元。

## 置换与转置
### 置换矩阵

左乘置换矩阵 $\mathbf{P}$ 进行行交换。置换矩阵就是单位矩阵行交换之后的结果。$n\times n$ 的置换矩阵共有 $n!$ 种。

![[Pasted image 20250906175451.png]]

#### 置换矩阵的奇偶性

- **偶置换 (Even Permutation)**: 如果一个置换可以通过偶数次对换来实现，那么它就是一个偶置换。
    
- **奇置换 (Odd Permutation)**: 如果一个置换可以通过奇数次对换来实现，那么它就是一个奇置换。
#### 其他性质

 1. 两个置换矩阵 P₁ 和 P₂ 的乘积仍然是一个置换矩阵。P 的逆矩阵也是一个置换矩阵 $$
\mathbf{P}^{\mathbf{T}}\mathbf{P}
=\mathbf{I}$$$$\mathbf{P}^{-1} = \mathbf{P}^T$$

2. 每行每列有且只有一个 1
	$\to$ P 的列向量是两两正交的：任意两个不同列向量的点积（dot product）都为零。
3. 如果矩阵 A 是可逆的，那么存在一个置换矩阵 P，可以预先对 A 的行进行重排，从而使得对 PA 进行（高斯）消元时在主元（pivot）位置上不会遇到零。此时，PA 可以进行 LU 分解，即 **PA = LU**。
	$\to$ 可以加一列标记序号，方便得到 P
![[Pasted image 20250906181039.png]]
#### 部分主元：减少约化误差

小主元不安全 $\to$ 我们进行行交换，尽可能得到最大的主元

（在计算机进行浮点数运算时，精度是有限的。当一个非常大的数 (`m * R₁` 中的元素) 与一个普通大小的数 (`R₂` 中的元素) 相减时，会发生**舍入误差 (Round-off Error)**，导致有效数字大量丢失。）

![[Pasted image 20250906181408.png]]

### 行置换与列置换

右乘列置换矩阵，完成列交换

$\to$ $C(PAQ)\neq C(A)$

### 转置矩阵

转置：行列交换

$A^T$ 的列是 $A$ 的行

![[Pasted image 20250906204331.png]]

![[Pasted image 20250906204339.png]]

#### 性质

![[Pasted image 20250906204907.png]]

$\to$ (2) AB 是 A 列的线性组合，$B^TA^T$ 是 $A^T$ 行的线性组合

	转置：逆序

$\to$ (3) 证明：同时对 $\mathbf{A}\mathbf{A}^{-1}=\mathbf{I}$ 两侧进行转置

![[Pasted image 20250907080520.png]]

### 内积

内积即点乘，可以写作 $x^Ty$

![[Pasted image 20250907104003.png]]

$$
(Ax)^T=x^T(A^Ty)
$$

#### 函数与内积

由于离散值内积：

$$x^T y = x_1 y_1 + x_2 y_2 + \dots + x_n y_n = \sum_{i=1}^n x_i y_i$$

得到函数内积的定义：

$$
x^Ty=\int_{-\infty}^{\infty} x(t)y(t) \, dt 
$$

而由于 $(Ax)^Ty=x^T(A^Ty)$，$A$ 为 $\frac{d}{dt}$ 微分算子

左边 $(Ax)^Ty$ 就是 $\int_{-\infty}^{\infty} \frac{dx}{dt}y(t) \, dt$

右边 $x^T(A^Ty)=\int_{-\infty}^{\infty} x(t)(A^Ty) \, dt$

而左边分部积分法

$$
\int_{-\infty}^{\infty} \frac{dx}{dt}y(t) \, dt=
 \left. x(t)y(t) \right|_{-\infty}^{\infty} - \int_{-\infty}^{\infty} x(t)\frac{dy}{dt} \, dt
$$

在工程问题中，$x(t)y(t)|_{-\infty}^{\infty}$ 趋于零

得到

$$

\int_{-\infty}^{\infty} x(t)(A^Ty) \, dt = - \int_{-\infty}^{\infty} x(t)\frac{dy}{dt} \, dt

$$

我们可以得到 $A=\frac{d}{dt}$ 的转置 $A^T=-\frac{d}{dt}$

### 对称矩阵

 对称矩阵是指矩阵的转置等于其自身的矩阵，即满足 $A^T = A$ 的矩阵。

 ![[Pasted image 20250907112232.png]]

 $\to$ 对称矩阵的逆还是对称矩阵。

	$$

(S^{-1})^T = (S^T)^{-1}=S^{-1}

$$
#### 对称积 $A^TA,AA^T,LDL^T$
$$

(A^TA)^T = A^T(A^T)^T=A^TA

$$
$$

(AA^T)^T = (A^T)^TA^T=AA^T

$$
##### 消元中的对称
对称矩阵由于其对称性，高斯消元时，只需要对一个三角矩阵进行运算，计算量减小了一半。运用这种思想，我们得到
$$

S=LDL^T

$$
- **L**: 一个**单位下三角矩阵** (对角线上全是1)。
        
- **D**: 一个**对角矩阵**，其对角元是消元过程中产生的**主元 (Pivots)**。
        
- **Lᵀ**: `L` 的转置，它是一个**单位上三角矩阵**。
![[Screenshot 2025-09-07 at 15.38.54.png]]
![[Pasted image 20250907154025.png]]
理解方法，消元时，$L$消去列，$L^T$消去行，二者互为转置矩阵，最后剩下来主元对角线
## 导数与有限差分
用矩阵来模拟导数
![[Pasted image 20250907162016.png]]
#TODO
